/* Date: 2015-01-07T15:28:45Z Path: js/app/appdeal.js */
define("ibar-faq",function(i,t,e){"use strict";var a='<div class="dialog_ser"><div class="faq_title"><span class="title">请您选择咨询类型</span><span class="close"><img class="close_ser" src="http://chat.jumei.com/images/ser_close.jpg"></span></div><div class="faq_content" id="faq_content"></div></div>',n=$(a),s={dialog:null,manager:function(){this.addContent(),this.show(),this.bindEvents()},content:[{be:"售前咨询",fe:'<a href="http://chat.jumei.com/custom?groupid=155" target="_blank">极速免税店咨询</a>'},{be:"售后咨询",fe:'<a href="http://chat.jumei.com/custom?groupid=157" target="_blank">配送服务</a><a href="http://chat.jumei.com/custom?groupid=158" target="_blank">售后服务</a><a href="http://chat.jumei.com/custom?groupid=159" target="_blank">产品问题</a>'},{be:"投诉建议",fe:'<a href="http://chat.jumei.com/custom?groupid=162" target="_blank">投诉快递</a><a href="http://chat.jumei.com/custom?groupid=165" target="_blank">投诉产品</a><a href="http://chat.jumei.com/custom?groupid=116" target="_blank">投诉客服</a><a href="http://chat.jumei.com/custom?groupid=117" target="_blank">投诉其他</a>'}],show:function(){$("body").trigger("FaqEvent")},addContent:function(){for(var i=this.content,t=i.length,e="",a=0;t>a;a++)e+='<li class="li_on">'+i[a].be+"</li>";n.find("#faq_content").html(e),this.dialog=new Jumei.ui.Dialog("body",{elem:n,dragHandle:".dialog_ser",overlayClose:!0,effects:"fade",trigger:"FaqEvent"})},bindEvents:function(){var i=n.find("li"),t=n.find(".close"),e=this.content,a=this.dialog;i.hover(function(){var i=$(this).index();$(this).html(e[i].fe).addClass("li_on_hover")},function(){var i=$(this).index();$(this).html(e[i].be).removeClass("li_on_hover")}),t.bind("click",function(){a.close()})}};s.init=function(){null==s.dialog?s.manager():s.show()},e.exports=s}),define("ibar-favorite",function(i,t,e){function a(i){var t,e=i.onSale,a=i.willSale,n=[];if(n.push('<div class="ibar-moudle-wrap ibar_plugin" id="iBarFavorite">'),n.push('<h2 class="ibar_plugin_title"><span class="ibar_plugin_name">今日疯抢</span></h2>'),n.push('<div class="ibar_plugin_content">'),e&&e.length){n.push('<div class="ibar-moudle-product">');for(t in e){var s=e[t].discount>9.5?"":e[t].discount;n.push('<div class="imp_item"><a href="'+e[t].url+'?from=ibar_mywish_onsale" title="'+e[t].deal_name+'" target="_blank" class="pic">'),n.push('<img src="'+e[t].pic+'" width="100" height="100"/></a>'),n.push('<p class="tit"><a href="'+e[t].url+'?from=ibar_mywish_onsale" title="'+e[t].deal_name+'" target="_blank">'),n.push("<span>"+s+"折/</span>"+e[t].deal_name+"</a>"),n.push('</p><p class="price"><em>¥</em>'+e[t].discounted_price+"<del>¥"+e[t].original_price+'</del></p><a href="javascript:;" class="imp-addCart" sku="'+e[t].sku_no+'" hashid="'+e[t].hash_id+'" img="'+e[t].pic+'">加入购物车</a>'),n.push("</div>")}n.push("</div>")}else n.push(a.length?'<div class="ibar-nothing"><div class="txt">您没有在售中的<br/><span>心愿商品喔！</span></div></div>':'<div class="ibar-nothing"><div class="txt">您的心愿单没商品<br/><span>快去添加吧</span></div></div>');if(e.length||a.length){if(n.push('<div class="ibar-moudle-product soon">'),n.push("<h2>即将开抢</h2>"),a.length)for(t in a){var r=0===a[t].is_published_price?"??":a[t].discounted_price;n.push('<div class="imp_item">'),n.push('<div class="imp-starttime">'+a[t].start_time+"开抢</div>"),n.push('<a href="'+a[t].url+'?from=ibar_mywish_willsale" title="'+a[t].deal_name+'"  target="_blank" class="pic">'),n.push('<img src="'+a[t].pic+'" width="100" height="100"/></a><p class="tit"><a href="'+a[t].url+'?from=ibar_mywish_willsale" title="'+a[t].deal_name+'" target="_blank">'+a[t].deal_name+"</a>"),n.push('<p class="wish-num">已有'+a[t].wish_number+"人许愿</p>"),n.push('</p><p class="price"><em>¥</em>'+r+"<del>¥"+a[t].original_price+"</del></p>"),n.push("</div>")}else n.push('<div class="ibar-nothing"><div class="txt">没有即将开抢的<br/><span>心愿商品喔！</span></div></div></div>');n.push("</div>")}return n.push("</div></div>"),n.join("")}var n={init:function(i){$.getJSON("http://www."+JM.RM_SITE_MAIN_MAINURL+"/i/ajax/sidebar_wishdeal?callback=?",null,function(t){var e=a(t);i.container.append(e),$(".imp-addCart").click(function(){var i=$(this).attr("sku"),t=$(this).attr("hashid"),e=$(this).attr("img"),a={elem:$(this),img:e,sku:i,hashid:t,from:"ibar_addcart",num:1,which_cart:"all"};Jumei.app.iBar.addCart(a)})})}};e.exports=n}),define("ibar-asset",function(i,t,e){function a(i){var t,e=[],a=i.red_envelope_count,n=i.promocards_count,s=i.account,r=i.red_envelope_list,o=i.promocards_list;if(e.push('<div class="ibar-Asset-wrap ibar-moudle-wrap ibar_plugin" id="iBarAsset">'),e.push('<h2 class="ibar_plugin_title"><span class="ibar_plugin_name">我的财产</span></h2>'),e.push('<div class="ibar_plugin_content">'),e.push('<div class="ia-head-list clearfix">'),e.push('<a href="http://www.'+JM.RM_SITE_MAIN_MAINURL+'/i/membership/show_promocards?from=ibar_property_xianjinquan" target="_blank" class="ihl-quan fl"><div class="num">'+n+'</div><div class="text">现金券</div></a>'),e.push('<a href="http://www.'+JM.RM_SITE_MAIN_MAINURL+'/i/membership/show_red_envelope?from=ibar_property_hongbao"  target="_blank" class="ihl-hg fl"><div class="num">'+a+'</div><div class="text">红包</div></a>'),e.push('<a href="http://www.'+JM.RM_SITE_MAIN_MAINURL+'/i/account/balance?from=ibar_property_yue" target="_blank" class="ihl-money fl"><div class="num">¥'+s+'</div><div class="text">余额</div></div>'),e.push("</a>"),e.push('<div class="ga-expiredsoon">'),e.push('<div class="es-head">即将过期现金券</div>'),o&&o.length){e.push('<div class="ia-coupon-list">');for(t in o)e.push('<div class="icl-item">'),e.push('<p class="name">'+o[t].title+"</p>"),e.push('<div class="clearfix"><span class="sale fl">'+o[t].satisfied+'</span><span class="pri fr"><em>¥</em>'+o[t].amount+"</span></div>"),e.push('<p class="exprietime">过期时间  '+o[t].expire_time+"</span></p>"),e.push("</div>");o.length>2&&e.push('<a href="http://www.'+JM.RM_SITE_MAIN_MAINURL+'/i/membership/show_promocards?from=ibar_property_xianjinquan_more" target="_blank" class="ga-view-more">查看更多</a>'),e.push("</div>")}else e.push('<div class="ia-none">您还没有可用的现金券哦！</div>');if(e.push("</div>"),e.push('<div class="ga-expiredsoon">'),e.push('<div class="es-head">即将过期红包</div>'),r&&r.length){e.push('<div class="ga-hongbao-list">');for(t in r)e.push('<div class="ihl-item">'),e.push('<div class="pri"><em>¥</em>'+r[t].amount+"</span></div>"),e.push('<p class="info">'+r[t].satisfied+"</p>"),e.push('<p class="exprietime">过期时间  '+r[t].expire_time+"</p>"),e.push("</div>");r.length>2&&e.push('<a href="http://www.'+JM.RM_SITE_MAIN_MAINURL+'/i/membership/show_red_envelope?from=ibar_property_hongbao_more" target="_blank" class="ga-view-more">查看更多</a>'),e.push("</div>")}else e.push('<div class="ia-none">您还没有可用的红包哦！</div>');return e.push("</div>"),e.push("</div></div>"),e.join("")}var n={init:function(i){$.getJSON("http://www."+JM.RM_SITE_MAIN_MAINURL+"/i/ajax/sidebar_property?callback=?",null,function(t){var e=a(t);i.container.append(e)})}};e.exports=n}),define("ibar-cart",function(i,t,e){var a=function(i,t,e){for(var a=0,n=i,s=0;s<i.length;s++)if(i.charCodeAt(s)>256?a+=2:a++,a>t){n=i.slice(0,s)+(e||"…");break}return n},n={product:"聚美优品",media:"名品特卖",global:{name:"海外直邮",group:!0},promo_cards:"聚美红包"},s=["product","media","global","promo_cards"],r=function(i,t){var e=null,a=null;for(var n in s){if(i===s[n])return e;a=t.find(".ibar_cart_"+s[n]),a.length>1?e=$(a[a.length-1]):1==a.length&&(e=a)}},o=function(i){var t=n[i],e=typeof t;return"string"===e?t:"object"===e?t.name:null},l=function(i){var t=n[i],e=typeof t;return"string"===e?!1:"object"===e&&t.group?!0:!1},c=0,d=function(i){var t,e,a,n,s,r,o=null,l=parseInt(1e3*i);return e=l,e>0&&(t=parseInt(e/864e5).toString(),t=t.length>1?t:"0"+t,e%=864e5,a=parseInt(e/36e5).toString(),a=a.length>1?a:"0"+a,e%=36e5,n=parseInt(e/6e4).toString(),n=n.length>1?n:"0"+n,s=parseInt(e%6e4/100),e=parseInt(s/10),r=s-10*e,e=e.toString().length>1?e:"0"+e,o={minute:n,second:e,milisec:r}),o},p={frame:"<div class='ibar_plugin ibar_cart_content'><div class='ibar_plugin_title'><span class='ibar_plugin_name'>购物车<span class='ibar_cart_timer'></span></span></div><div class='ibar_plugin_content'><div class='ibar_cart_group_container'></div><div class='ibar_cart_handler'><div class='ibar_cart_handler_header clearfix'><span class='ibar_cart_handler_header_left'>共 <span class='ibar_cart_total_quantity ibar_pink'>0</span> 件商品</span><span class='ibar_cart_total_price ibar_pink'></span></div><a class='ibar_cart_go_btn' href='http://cart.jumei.com/i/cart/show?from=ibar_cart_button' target='_blank'>去购物车结算</a></div></div></div>",dealItem:"<li class='ibar_cart_item clearfix'><div class='ibar_cart_item_pic'><a target='_blank'><img src='' alt=''><span class='ibar_cart_item_tag png'></span></a></div><div class='ibar_cart_item_desc'><span class='ibar_cart_item_name_wrapper'><span class='ibar_cart_item_global'>[极速免税店]</span><a class='ibar_cart_item_name' target='_blank'></a></span><div class='ibar_cart_item_sku ibar_text_ellipsis'><span></span></div><div class='ibar_cart_item_price ibar_pink'><span class='unit_price'></span><span class='unit_plus'> x </span><span class='ibar_cart_item_count'></span></div></div></li>",cbitems:"<li class='ibar_cart_cbitems ibar_cart_item'><ul class='clearfix ibar_cart_cbitems_content'></ul><div class='ibar_cart_item_price'><span class='ibar_cb_tips'>组合购买价</span><span class='unit_price ibar_pink'></span><span class='unit_plus'> x </span><span class='ibar_cart_item_count'></span></div></li>",cartGroup:"<div class='ibar_cart_group'><div class='ibar_cart_group_header clearfix'><span class='ibar_cart_group_title'></span><span class='ibar_cart_group_shop ibar_text_ellipsis'></span><span class='ibar_cart_group_baoyou ibar_pink'></span></div><ul class='ibar_cart_group_items'></ul></div>",loadingText:"<p class='ibar_cart_loading_text'>正在为您努力地加载数据！</p>"},h=function(i){this.element={},this.id=i.id||this.id,this.draw(i.container),this.fixIE(),this.initTimer(),this.render(),this.bindEvents()};h.prototype={id:"iBarCart",draw:function(i){var t=$(p.frame).attr("id",this.id);this.element.root=t,this.element.groupContainer=t.find(".ibar_cart_group_container"),this.element.cartTimer=t.find(".ibar_cart_timer"),this.element.handlebar=t.find(".ibar_cart_handler"),this.element.handlebarQuanity=t.find(".ibar_cart_total_quantity"),this.element.handlebarPrice=t.find(".ibar_cart_total_price"),$(i).append(t)},fixIE:function(){var i=!!~navigator.userAgent.toLowerCase().indexOf("msie 6.0");i&&($(".ibar_cart_group_container").css({height:document.documentElement.clientHeight-140+"px"}),this.element.groupContainer.hover(function(){$(this).addClass("ibar_cart_group_container_hover_ie6")},function(){$(this).removeClass("ibar_cart_group_container_hover_ie6")}))},bindEvents:function(){var i=this,t=$("#iBar");Jumei.app&&Jumei.app.iBar&&Jumei.app.iBar.cartUpdate(function(){i.render()}),t.bind("afterreopenplugin",function(t,e){"iBarCart"===e&&i.fixHandlerPos()})},render:function(){this.clear(),this.toggleCartState("loading"),this.getAjaxData({_ajax_:1,which_cart:"all"},function(i){Jumei.app&&Jumei.app.iBar&&Jumei.app.iBar.cartNumberUpdate(i.quantity||0),i.quantity>0?(this.toggleCartState("show"),this.refreshTimer(i.etime),this.renderGroups(i,this.element.groupContainer),this.refreshHandler(i),this.fixHandlerPos()):this.toggleCartState("empty")},this)},fixHandlerPos:function(){var i,t=this.element,e=t.root.find(".ibar_plugin_content").outerHeight(),a=t.handlebar.outerHeight();t.groupContainer.css({position:"static"}),i=t.groupContainer.outerHeight(),e>i+a?(t.groupContainer.css({position:"relative"}),t.handlebar.removeClass("ibar_cart_handler_fixed").addClass("ibar_cart_handler_attached").css({top:i})):(t.groupContainer.css({position:"absolute"}),t.handlebar.removeClass("ibar_cart_handler_attached").addClass("ibar_cart_handler_fixed").css({top:"auto"}))},toggleCartState:function(i){"empty"===i?(this.element.groupContainer.addClass("ibar_cart_empty").removeClass("ibar_cart_loding"),this.element.handlebar.hide(),this.element.cartTimer.hide()):"show"===i?(this.element.groupContainer.removeClass("ibar_cart_empty").removeClass("ibar_cart_loding"),this.element.handlebar.show(),this.element.cartTimer.show()):"loading"===i&&(this.element.groupContainer.addClass("ibar_cart_loding").append($(p.loadingText)),this.element.handlebar.hide(),this.element.cartTimer.hide())},clear:function(){this.element.handlebarQuanity.text(0),this.element.handlebarPrice.text("￥0"),this.element.groupContainer.empty()},initTimer:function(){var i=this,t=this.cartTimerInterval=function(){c-=.1;var t=d(c);t?i.renderTimer(t.minute,t.second,t.milisec,c):i.renderTimer(0,0,0,c)};setInterval(t,100)},renderTimer:function(i,t,e,a){var n="";n=a>0?"<span class='ibar_pink'>"+i+"分"+t+"."+e+"秒</span>后清空":"已超时，请尽快结算",n&&this.element.cartTimer.html(n)},refreshTimer:function(i,t){!t&&window.global_cart_count&&(window.global_cart_count=i),c=i},refreshHandler:function(i){i&&(this.element.handlebarQuanity.text(i.quantity),this.element.handlebarPrice.text("￥"+Number(i.total_amount).toFixed(2)))},renderItem:function(i,t){if(i){var e=$(p.dealItem),n=a(i.short_name,32);if("retail_global"===i.item_category&&e.find(".ibar_cart_item_global").css({display:"inline"}),i.url=-1===String.prototype.indexOf.call(i.url,"?")?i.url+"?from=ibar_cart":i.url+"&from=ibar_cart",e.find(".ibar_cart_item_pic a,.ibar_cart_item_name").attr({title:i.short_name,href:i.url}),e.find(".ibar_cart_item_name").html(n),e.find(".ibar_cart_item_pic img").attr({alt:i.short_name,src:i.image_100}),i.attribute||i.capacity){var s=i.attribute+(i.capacity?" "+i.capacity:"");e.find(".ibar_cart_item_sku span").text("型号："+s).attr("title",s)}e.find(".ibar_cart_item_price .unit_price").html("<em>￥</em>"+parseFloat(i.item_discount_price).toFixed(2)),e.find(".ibar_cart_item_count").text(i.quantity),i.sale_status&&e.find(".ibar_cart_item_tag").addClass("ibar_cart_item_tag_active ibar_cart_item_tag_soldout"),t.append(e)}},renderGroups:function(i,t){if(i)for(var e in i){var a=l(e);if(o(e))if(a===!0)for(var n in i[e])this.renderGroup(e,i[e][n],t);else a===!1&&this.renderGroup(e,i[e],t)}},renderGroupBySeq:function(i,t,e){var a=r(t,e);a?a.after(i):e.prepend(i)},renderGroup:function(i,t,e){if(t&&t.items&&t.items.length){var a=$(p.cartGroup).addClass("ibar_cart_"+i);a.find(".ibar_cart_group_title").text(o(i)),a.find(".ibar_cart_group_baoyou").html(t.delivery_fee_desc),t.name&&a.find(".ibar_cart_group_shop").text(t.name).attr("title",t.name+" 发货");var n=a.find(".ibar_cart_group_items");for(var s in t.items)t.items[s].is_cb?this.renderCbGroup(n,t.items[s]):this.renderItem(t.items[s],n);this.renderGroupBySeq(a,i,e)}},renderCbGroup:function(i,t){var e=null,a=$(p.cbitems);a.find(".ibar_cart_item_price .unit_price").text("￥"+Number(t.item_price).toFixed(2)),a.find(".ibar_cart_item_count").text(t.quantity),t.sale_status&&a.find(".ibar_cart_cbitems").addClass("ibar_cart_gb_gray"),e=a.find(".ibar_cart_cbitems_content");for(var n=0,s=t.sub_items.length;s>n;n++)this.renderItem(t.sub_items[n],e);i.append(a)},getAjaxData:function(i,t,e){$.getJSON("http://cart."+JM.RM_SITE_MAIN_MAINURL+"/i/ajax/get_cart_data_right?callback=?",i,function(i){i&&t.call(e||this,i)})}};var u=null;h.init=function(i){return null==u&&(u=new h(i)),u},e.exports=h}),define("ibar-recharge",function(i,t,e){var a=function(i){function t(){J.find(".gateway_list>li").click(function(){var i=$(this),t=i.find(">input");t.attr("disabled")!==!1||i.hasClass("weihu")||(t.attr("checked",!0),i.siblings("li").removeClass("ul_on").addClass("ul_off").find(">input").attr("checked",!1),i.removeClass("ul_off").addClass("ul_on"))})}function e(){var i=ot.find(".bank-ul").find("li"),t=ot.find(".g-ul").find("li"),e=ot.find(".more-gate"),a=i.filter(":gt(7)").hide();a.length?e.bind("click",function(){e.hasClass("shrink")?(a.hide(),e.removeClass("shrink")):(e.addClass("shrink"),a.show())}):e.hide(),t.bind("click",function(){var i=$(this);i.hasClass("selected")||(t.not(i).removeClass("selected"),i.addClass("selected").find("input").trigger("click")),!E&&M()})}function a(){if(!A){var i=W;O.bind("focus",function(){$.trim(O.val())==i&&O.val("").removeClass("color-hook")}).bind("blur",function(){$.trim(O.val())||O.val(i).addClass("color-hook")}).triggerHandler("blur")}}function n(){var i=W;O.bind("focus",function(){var t=$.trim(O.val());t&&t!=i&&(w(U).show(),G?(_(F,t),F.filter(":visible").length||U.addClass("show-zi").find(".zoom-in").text(t)):U.addClass("show-zi").find(".zoom-in").text(t))}),O.bind("click",function(i){i.stopPropagation();var t=$(this).val();t||J.find(".ibar_recharge-contact").trigger("click")})}function s(){J.find(".ibar_recharge-contact").bind("click",function(i){i.stopPropagation(),w(U).show(),G?F.text(function(i,t){return t}).show():U.addClass("show-nh")})}function r(){D.delegate("li","click",function(){var i=$(this),t=$.trim(i.text());O.val(t).removeClass("color-hook"),F.not(i).removeClass("selected"),i.addClass("selected"),U.hide(),m(t)&&(k(),!E&&M())})}function o(){var i=parseInt($.trim(H.text()),10);L.each(function(t,e){var a=$(e),n=parseInt($.trim(a.find("span").text()),10);return i==n?(a.addClass("selected"),!1):void 0})}function l(){function i(i){return i.stopPropagation(),L.length?void(R.is(":visible")?R.hide():R.show()):(!E&&M("请检查手机号填写是否正确。"),!1)}N.bind("click",i),E&&$(".ibar_recharge-arrow").bind("click",i),R.delegate("li","click",function(){var i=$(this),t=$.trim(i.find("span").text());i.hasClass("selected")||(i.addClass("selected"),L.not(i).removeClass("selected"),H.text(t)),m(O.val())?k():K.text(pt[t]||pt[parseInt(t,10)]),R.hide()})}function c(){$(document).bind("click",function(){U.hide(),R.hide()})}function d(i,t){t!==P?(U.addClass("show-zi").show(),t>0?U.find(".zoom-in").text(i):U.hide().removeClass("show-zi"),13===t?m(i)?(k(),!E&&M(),x(!0),setTimeout(function(){U.fadeOut()},300)):(U.removeClass("show-zi").addClass("show-pe"),x(!1)):(x(E),U.removeClass("show-pe")),P=t):U.hide()}function p(i,t,e,a){e.preventDefault();var n=F,s=e.keyCode,r=n.filter(".selected"),o=n.filter(":visible");switch(s){case 13:return a.val($.trim(r.text())),U.hide(),k(),!E&&M(),void 0;case 38:return void h(o,r);case 40:return void u(o,r)}U.show(),_(n,i),13===t?m(i)?(k(),!E&&M(),x(!0),setTimeout(function(){U.fadeOut()},300)):(U.removeClass("show-zi").addClass("show-pe"),x(!1)):(x(E),U.removeClass("show-pe")),o=n.filter(":visible"),o.length?U.removeClass("show-zi"):(P==t?P=0:"",d(i,t))}function h(i,t){var e=i.length;if(e){var a=i.index(t);a=0>=a?e-1:a-1,t.removeClass("selected"),i.eq(a).addClass("selected")}}function u(i,t){var e=i.length;if(e){var a=i.index(t);a=a==e-1||0>a?0:a+1,t.removeClass("selected"),i.eq(a).addClass("selected")}}function _(i,t){i.each(function(i,e){var a=$(e),n=a.text();n.startWith(t)?a.html(f(t,n)).show():a.hide()})}function f(i,t){return t.replace(i,'<span class="ibar_pink">'+i+"</span>")}function m(i){return X.test(i)||Y.test(i)}function b(){O.bind("keypress",function(i){var t=i.keyCode,e=$(this),a=e.val().length;return!/\d/.test(String.fromCharCode(t))&&t>9&&!i.ctrlKey?void i.preventDefault():void(3!==a&&8!==a||8==t||e.val(function(i,t){return t+"-"}))}),O.bind("keyup",function(i){var t=$(this),e=t.val(),a=e.length,n="";w(U),11==a&&(n=v(e),n&&(t.val(n),e=n,a=n.length)),G?p(e,a,i,t):d(e,a)})}function v(i){if(Z.test(i)){var t=i.split("");return t.splice(3,0,"-"),t.splice(8,0,"-"),t.join("")}return""}function g(i){if(w(U),"undefined"!=typeof i){i=$.trim(i);var t=m(i);return i.length?t?"":(U.addClass("show-pe").show(),O.focus()):(U.addClass("show-np").show(),O.focus()),t}return!1}function w(i){return i.removeClass("show-np show-pe show-zi show-nh")}function x(i){i?q.attr("disabled",!1).removeClass("disabled"):q.attr("disabled",!0).addClass("disabled")}function y(){return!!lt.filter(":checked").length}function k(){var i=$.trim(O.val()).replace(/-/g,""),t=$.trim(H.text());return z==i&&ct?(x(!0),void C(ct,t)):(z=i,void $.ajax({url:it,data:{hp:i},dataType:tt,success:function(e){if(e&&e[i]){e=e[i],pt={};var a=e.sku_list,n=[],s=null,r=null;if(ct=a,V.text(e.hp_info.province_name+e.hp_info.trade),st.val(e.hp_info.province_name+e.hp_info.trade),rt.val(e.hp_info.mall_id),a){Q.removeClass("show-so"),x(!0);for(var o in a){var l=a[o];pt[l.market_price]=l.customers_price,n.push(parseInt(l.market_price,10)),parseInt(l.market_price,10)==parseInt(t,10)&&(s=l),r=l}s||(s=r,H.text(s.market_price)),et.val(s.sku_no),at.val(s.customers_price),nt.val(s.market_price),K.text(s.customers_price),I(n)}else Q.addClass("show-so"),x(!1)}else x(!1)},error:function(){}}))}function C(i,t){for(var e in i){var a=i[e];parseInt(a.market_price,10)==parseInt(t,10)&&(et.val(a.sku_no),at.val(a.customers_price),nt.val(a.market_price),K.text(a.customers_price))}}function I(i){i=j(i);var t=i.length,e="",a=-1;if(t>1){e+="<ul>",a=Math.ceil(t/2)-1;for(var n=0;t>n;n++)e+="<li><span>"+i[n]+"</span>元</li>",n==a&&(e+='</ul><ul class="last-ul">');e+="</ul>"}else 1==t?e+='<ul class="last-ul"><li><span>'+i[0]+"</span>元</li></ul>":e="暂无数据";L=R.html(e).find("li"),o()}function j(i){var t=i.length,e=[],a=[],n=0;if(t>1){for(;t>n;n++){var s=parseInt(i[n],10);100>s?a.push(s):e.push(s)}i=e.concat(a)}return i}function T(){m(O.val())||x(!1)}function M(i){i?dt.show().find("p").html(i)[0].scrollIntoView():dt.hide()}function B(i){var t=[],e={};if(document.cookie&&""!==document.cookie){for(var a=document.cookie.split(";"),n=a.length,s=0;n>s;s++){var r=$.trim(a[s]);r.indexOf(i)>-1&&(e[r.split("=")[1]]=!0)}for(var o in e)t.push(o);t=t.reverse(),t.length>10&&(t.length=10)}return t}function S(){var i=B("mobile_history"),t=i.length,e=[];if(t){for(var a=0;t>a;a++)e.push("<li>"+v(i[a])+"</li>");D.html(e.join("")),F=D.find("li"),G=!!F.length}}i=i||{};var E=!1,A="placeholder"in document.createElement("input"),J=$(i.form?i.form:"#ibar_recharge-form"),q=J.find(":submit"),N=J.find(".ibar_recharge-mod"),P=0,z="",R=J.find(".ibar_recharge-vbox"),H=J.find(".ibar_recharge-val"),L=R.find("li"),O=J.find(".ibar_recharge-input").find("input"),W=O.attr("placeholder"),U=J.find(".ibar_recharge-tooltip"),D=U.find(".phone-list"),F=D.find("li"),G=!!F.length,Q=J.find(".sell-status"),K=Q.find(".ibar_recharge-price"),V=J.find(".ibar_recharge-operator"),X=/^1[3-8]\d{1}-\d{4}-\d{4}$/,Y=/^1[3-8]\d{9}$/,Z=/^\d{11}$/,it="/m/ajax/get_info_skus/",tt="json",et=J.find('input[name="sku_no[]"]'),at=J.find('input[name="customers_price[]"]'),nt=J.find('input[name="market_price[]"]'),st=J.find('input[name="province[]"]'),rt=J.find('input[name="mall_id[]"]'),ot=J.find(".ibar_recharge-gateway"),lt=ot.find('input[name="gateway"]'),ct=null,dt=J.find(".notification"),pt=i.priceMap||window.priceMap;J.submit(function(){return g(O.val())?E||y()?void 0:(M("请选择支付方式。"),!1):!1}),String.prototype.startWith=function(i){return 0===this.indexOf(i)};var ht={init:function(i){i?E=i.home:"",E?(S(),it="//cart.jumei.com"+it+"?_ajax_=1",tt="jsonp",et=J.find('input[name="sku_no"]'),at=J.find('input[name="customers_price"]'),nt=J.find('input[name="market_price"]'),st=J.find('input[name="province"]'),rt=J.find('input[name="mall_id"]')):(e(),t(),T()),c(),o(),s(),a(),n(),r(),l(),b()}};ht.init({home:i.home})},n={frame:"<div class='ibar_plugin ibar_recharge_content'><div class='ibar_plugin_title'><span class='ibar_plugin_name'>手机充话费</span></div><div class='ibar_plugin_content'><form action='//cart."+JM.RM_SITE_MAIN_MAINURL+"/m/forward/' target='_blank' method='get' class='ibar_recharge_form '><div class='ibar_recharge-field ibar_recharge-num' style='*z-index: 3; *position: relative'><label>号码</label><div class='ibar_recharge-input ibar_recharge-fl'><div class='ibar_recharge-iwrapper'><input type='text' maxlength='13' name='hp' placeholder='手机号码' autocomplete='off'></div><i class='ibar_recharge-contact' title='查看充值历史'></i><div class='ibar_recharge-tooltip'><p class='no-phone ibar_pink'>请填写您的手机号码</p><p class='phone-error ibar_pink'>请填写正确的手机号码</p><p class='zoom-in ibar_pink'></p><ul class='phone-list'></ul><p class='no-history ibar_pink'>您还没有充值记录</p></div></div></div><div class='ibar_recharge-field' style='*z-index: 2'><label>面值</label><div class='ibar_recharge-fl ibar_recharge-vwrapper'><p class='ibar_recharge-mod'><span class='ibar_recharge-val'>100</span> 元</p><i class='ibar_recharge-arrow'></i><div class='ibar_recharge-vbox clearfix'><ul><li class='selected'><span>100</span>元</li><li><span>200</span>元</li><li><span>300</span>元</li><li><span>500</span>元</li></ul><ul class='last-ul'><li><span>10</span>元</li><li><span>20</span>元</li><li><span>30</span>元</li><li><span>50</span>元</li></ul></div></div></div><div class='ibar_recharge-field ibar_recharge-pwrapper'><label>售价</label><div class='ibar_recharge-fl'><p><span class='ibar_pink sell-status'><span class='on-sell'><span class='ibar_recharge-price'>98.70 ~ 99.80</span> 元</span><span class='sold-out'>暂时缺货</span></span><span class='ibar_recharge-operator'></span></p><input type='hidden' name='sku_no' value=''><input type='hidden' name='customers_price' value=''><input type='hidden' name='market_price' value=''><input type='hidden' name='from' value='ibar_mobile_recharge'><input type='hidden' name='province' value=''><input type='hidden' name='mall_id' value=''></div></div><div class='ibar_recharge-btn'><input type='submit' value='立即充值'></div></form></div></div>"},s={defaultOptions:{id:"iBarRecharge",home:!0,formSelector:".ibar_recharge_form",priceMap:{10:"9.87 ~ 10.07",20:"19.74 ~ 20.10",30:"29.61 ~ 30.00",50:"49.35 ~ 50.00",100:"98.70 ~ 100.00",200:"197.40 ~ 200.00",300:"296.10 ~ 300.00",500:"493.50 ~ 500.00"}},_draw:function(i){if(i.container){var t=$(n.frame).attr("id",i.id);return $(i.container).append(t),t}},init:function(i){i=$.extend({},s.defaultOptions,i);var t=s._draw(i);return i.form=t.find(i.formSelector),new a(i)}};e.exports=s}),define("ibar-tips",function(i,t,e){function a(i,t){var e=i.offset().top;e-=b.scrollTop(),t.css({top:e+"px"})}function n(){if(s=$("#iBar"),r=s.find("div.ibar_main_panel"),o=r.find("li.mpbtn_cart"),l=o.find("a"),0===_){c.append(d);var i=$(".tips_cash_box"),t=parseInt(h("tipsOneCookie")),e=function(){u("tipsOneCookie","1",{expires:1e3,path:"/",domain:w})};m-f>240&&(!t||1!==t)&&(i.show(),a(l,i),setTimeout(function(){i.hide(),e(),b.unbind("resize.cashbox")},15e3),i.is(":visible")&&b.bind("resize.cashbox",function(){a(l,i)}),i.find("a.ibar_closebtn").bind("click",function(t){i.remove(),e(),t.preventDefault(),b.unbind("resize.cashbox")}))}}var s,r,o,l,c,d,p;d='<div class="tips_cash_box"><div class="newuser_tips_cash"><h3>您已获得160元现金券</h3><p>今天之内下单最多立减40元</p><a class="coupon_btn" href="http://passport.jumei.com/i/account/signup" target="_blank">注册领取</a></div><s class="icon_arrow_white"></s><a href="javascript:;" class="ibar_closebtn" title="关闭"></a></div>',p='<div class="tips_cart_box"><div class="newuser_tips_cart"><h3>您已获得160元现金券</h3><p>今天之内下单最多立减40元</p><p>还有5分钟购物车就要清空了</p></div><s class="icon_arrow_white"></s><a href="javascript:;" class="ibar_closebtn" title="关闭"></a></div>';var h=Jumei.util.cookie.get,u=Jumei.util.cookie.set,_=parseInt(h("register_time"))||0,f=parseInt(h("first_visit_time"))||0,m=Math.ceil((new Date).getTime()/1e3),b=$(window),v=window.location.hostname.split("."),g=v.slice(-2),w=g.join("."),x={init:function(i){c=i.container,n()}};e.exports=x}),define("ibar-monitor",function(i,t,e){"use strict";var a=function(){window._gaq&&$("#iBar div.ibar_main_panel").find("a").bind("mousedown",function(){var i=$(this).parent()[0].className,t=i.match(/mpbtn_(\w+)\b/);t&&(t="ibar_"+t[1],"gotop"!==t&&window._gaq.push(["_trackEvent",t,"clicked"]))})};e.exports=a}),define("ibar-fly",function(i,t){var e=$(window),a={targeter:null,bubbler:null,bubbleAni:function(i,t){var a=this;i.fadeOut(10,function(){i.css({width:"45px",height:"45px"}),setTimeout(function(){var i=a.targeter.offset();i={left:i.left-e.scrollLeft(),top:i.top-e.scrollTop()},a.bubbler.css({position:"fixed",display:"block",opacity:1,top:i.top-13,left:i.left+4}).animate({top:i.top-40,opacity:0},{duration:800,complete:function(){a.bubbler.hide(),t&&t()}})},300)})},cartScale:function(){var i=this;i.targeter.css({zIndex:9992}),i.targeter.animate({scale:.3},{duration:100,step:function(t){i.targeter.css("transform","scale("+(1+t)+")")}}).animate({scale:.3},{duration:500,step:function(t){i.targeter.css("transform","scale("+(1.3-t)+")")}})},main:function(i){var t=this;t.targeter=i.targeter,t.starter=i.starter,t.bubbler=i.bubbler;var a,n=i.flyer,s=i.start,r=i.target,o=i.complete,l={left:s.left,top:s.top},c={left:r.left,top:r.top},d=i.unAnim,p=i.isIE6,h=i.speed?i.speed:1,u=void 0===i.bubble?!0:i.bubble,_=(i.hideDelay?i.hideDelay:"",p?!1:!0),f=i.targetOffset||{left:0,top:0},m=i.flyerOffset||{left:0,top:0},b=i.flyerResize||{x:15,y:15};n.css({left:s.left-e.scrollLeft(),top:s.top-e.scrollTop(),position:_?"fixed":"absolute"}),_?(l={left:s.left-e.scrollLeft(),top:s.top-e.scrollTop()},r&&(c={left:parseFloat(r.left-e.scrollLeft()+f.left),top:parseFloat(r.top-e.scrollTop()+f.top)})):r&&(c={left:parseFloat(r.left+f.left),top:parseFloat(r.top+f.top)});var v=_?0:e.scrollTop(),g=Math.min(l.top,c.top)-Math.abs(l.left-c.left)*(1/3);v>g&&(l.left==c.left&&(g=c.top),g=Math.min(v,Math.min(l.top,c.top))),h=p?h:h/2;var w=Math.sqrt(Math.pow(l.top-c.top,2)+Math.pow(l.left-c.left,2)),x=Math.ceil(Math.min(Math.max(Math.log(w)/.05-75,30),100)/h)+5,y=l.top==g?0:-Math.sqrt((c.top-g)/(l.top-g)),k=(y*l.left-c.left)/(y-1),C=c.left==k?0:(c.top-g)/Math.pow(c.left-k,2),$=Math.cos,I=Math.PI,j=(Math.min,Math.pow),T=-1;if(b&&(a={x:n.width(),y:n.height()}),d)t.bubbleAni(n,o);else var M=setInterval(function(){++T;var i=l.left+(c.left-l.left)*T/x,e=0===C?l.top+(c.top-l.top)*T/x:C*j(i-k,2)+g,s={left:i,top:e};if(b){var r=x/2,d=b.x-(b.x-a.x)*$(r>T?0:(T-r)/(x-r)*I/2),p=b.y-(b.y-a.y)*$(r>T?0:(T-r)/(x-r)*I/2);n.css({width:d+"px",height:p+"px"})}n.css({left:s.left+m.left+"px",top:s.top+m.top+"px"}),T==x-1&&t.cartScale(),T==x&&(clearInterval(M),u?t.bubbleAni(n,o):o&&o())},16)}};t.main=function(i){a.main(i)}}),define("cart-bar",function(i,t,e){"use strict";var a={getScrollNavInfo:function(i,t){var e={};return i.length>0?($.each(i,function(a){var n=$(i[a]).offset().top;t>=n&&t<$(i[a]).height()+n&&(e.id=$(i[a]).attr("id"),e.offsettop=n)}),e):void 0},navBranchShow:function(i){var t=$(window).scrollTop(),e=a.getScrollNavInfo(i.$navcon,t);if("undefined"!=e.id){var n=i.$container.find("#nav_"+e.id);t>=e.offsettop&&(n.addClass("act"),n.siblings().removeClass("act"))}else i.$navbrands.removeClass("act");t>200?i.$container.show():i.$container.hide()},navResizeShow:function(i){var t=i.$container.width();if($(window).width()>i.$body.width()+2*(t+15))i.$container.css({left:"50%","margin-left":.5*i.$body.width()+15});else{var e=$(window).width()-t-15;i.$container.css({left:e+"px","margin-left":0})}}},n=function(i){this.initElement(i.container,i.navcon,i.body),this.renderHandle()};n.prototype={initElement:function(i,t,e){this.$container=i,this.$body=e,this.$navcon=t,this.$navback=i.find(".nav_backtotop"),this.$navbrands=i.find(".nav_brands_group")},renderHandle:function(){this.$navbrands.length>0&&this.$navcon.length>0?this.scrollHandle():this.$container.show(),this.$navback.length>0&&this.$navback.bind("click",this.backHandle),this.resizeHandle()},scrollHandle:function(){var i=this;$(window).bind("scroll",function(){a.navBranchShow(i)}),a.navBranchShow(i)},resizeHandle:function(){var i=this;$(window).resize(function(){a.navResizeShow(i)}),a.navResizeShow(i)},backHandle:function(){$("html,body").animate({scrollTop:0},"easeOutExpo")}},n.init=function(i){return new n(i)},e.exports=n}),define("cart-box",function(i,t,e){"use strict";var a={frame:" <div class='cart_content' ><div class='cart_content_null'>购物车中还没有商品，<br/>快去挑选心爱的商品吧！</div><div class='cart_content_all'><div class='cart_left_time'><span class='cart_diff'></span>后购物袋被清空,请及时结算</div><div class='cart_content_center'></div><div class='con_all'><div class='price_whole'><span>共<span class='num_all'></span>件商品</span><span class='price_gongji'><em>¥</em><span class='total_price f_color'></span></span></div><div><a href='http://cart.jumeiglobal.com/i/cart/show/?from=home_navbar' class='cart_btn'>去购物车结算</a></div></div></div><span class='recent_deals_strangle'></span></div>",dealItem:"<div class='cart_con_over cart_con_single'><div class='single_pic'><a  target='_blank' ><img /></a></div><div class='single_info'><a  target='_blank' class='name'></a><span class='f_color'>¥</span><span class='f_color f_price'></span><span>x</span><span class='f_num'></span></div></div>",group:"<div class='cart_con_over cart_con_group'></div>",groupItem:"<div class='cart_con_single'><div class='single_pic'><a target='_blank'><img /></a></div><div class='single_info'><a></a></div></div>"},n=function(i){this.element={},this.draw(i.container),this.initBox(i.container),this.render()
};n.prototype={draw:function(i){var t=$(a.frame);this.element.parentE=i,this.element.root=t,this.element.numicon=i.find(".nav_cart_num"),this.element.contentNull=t.find(".cart_content_null"),this.element.contentAll=t.find(".cart_content_all"),this.element.groupContainer=t.find(".cart_content_center"),this.element.recentContainer=t.find(".recent_deals_strangle"),this.element.handlebarQuanity=t.find(".num_all"),this.element.handlebarPrice=t.find(".total_price"),this.element.cart_diff=t.find(".cart_diff"),i.find(".cart_content").length<1&&$(i).append(t)},initBox:function(i){var t=this;Jumei.util.hoverIntent(i,{interval:80,over:function(){t.render(),t.element.root.show(),t.element.root.hover(function(){$(this).find(".cart_con_over").hover(function(){$(this).addClass("single_hover")},function(){$(this).removeClass("single_hover")})},function(){})},timeout:120,out:function(){t.element.root.hide()}})},render:function(){var i=this;$.getJSON("http://cart."+JM.RM_SITE_MAIN_MAINURL+"/i/ajax/get_cart_data/?callback=?",{_ajax_:1,which_cart:"all"},function(t){"string"==typeof t&&(t=$.parseJSON(t)),i.clear(),t.quantity>0?(i.toggleCartState(!0),i.refreshTimer(t,i.element.cart_diff),i.renderGroup(t,i.element.groupContainer),i.refreshHandler(t),i.refreshNum(t)):i.toggleCartState(!1)})},toggleCartState:function(i){i?(this.element.contentNull.hide(),this.element.contentAll.show()):(this.element.contentNull.show(),this.element.contentAll.hide())},clear:function(){this.element.handlebarQuanity.text(0),this.element.handlebarPrice.text(0),this.element.groupContainer.empty(),this.element.numicon.hide()},refreshTimer:function(i,t){var e=i.etime;e>0?t.attr("diff",e):t.parent().html("已超过购物车商品保留时间，请尽快结算。"),"undefined"!=typeof cartCounter&&window.cartCounter.stop(),window.cartCounter=new Jumei.ui.TimeCounter(this.element.cart_diff,{format:"MM分SS.TT",dtime:100,onStart:function(){this.$target.html(this.html)},onEnd:function(){this.$target.html("已超过购物车商品保留时间，请尽快结算。")}})},refreshHandler:function(i){i&&(this.element.handlebarQuanity.text(i.quantity),this.element.handlebarPrice.text(i.total_amount))},refreshNum:function(i){if(i){var t=i.quantity;0===t?this.element.numicon.hide():(this.element.numicon.show().html(t),Jumei.app.iBar.cartNumberUpdate(t))}},updateUrl:function(i,t){return i+=i.indexOf("?")>-1?"&from="+t:"?from="+t},renderItem:function(i,t){if(i){var e=$(a.dealItem);i.url=this.updateUrl(i.url,"home_index_scrollbar_cart"),e.find(".single_pic a,.single_info a").attr({title:i.short_name,href:i.url}),e.find(".single_pic img").attr({alt:i.short_name,src:i.image_100}),e.find(".single_info a").html(i.short_name),e.find(".single_info .f_price").text(i.item_discount_price),e.find(".single_info .f_num").text(i.quantity),t.append(e)}},renderCpItem:function(i,t){if(i){var e=$(a.groupItem);i.url=this.updateUrl(i.url,"home_index_scrollbar_cart"),e.find(".single_pic a,.single_info a").attr({title:i.short_name,href:i.url}),e.find(".single_pic img").attr({alt:i.short_name,src:i.image_100}),e.find(".single_info a").html(i.short_name+"<em>x"+i.quantity+"</em>"),t.append(e)}},renderCp:function(i,t){if(i){for(var e=$(a.group),n=i.sub_items,s=0;s<n.length;s++)this.renderCpItem(n[s],e);var r="<div class='group_count'><span>组合购买价 </span><span class='group_count_price'><em>¥"+i.item_price+"</em>x"+i.quantity+"</span></div>";e.append(r),t.append(e)}},renderGroup:function(i,t){var e,a=0;if(i){var n=i.details;for(var s in n)n[s].is_cb?(a++,"1"==n[s].is_cb&&this.renderCp(n[s],t)):this.renderItem(n[s],t);e=80*n.length+80*a,e>240?t.css("height","240px"):t.css("height",e)}this.checkHeight()},checkHeight:function(){var i=$(window).height()-(this.element.parentE.offset().top-$(document).scrollTop())-this.element.root.height(),t=this.element.parentE.offset().top-this.element.root.offset().top;5>i&&this.element.root.css("top",i-20),this.element.recentContainer&&this.element.recentContainer.css("top",0>t?Math.abs(t-20):t+20)}},n.init=function(i){return new n(i)},e.exports=n}),define("ibar",["ibar-fly","ibar-monitor","ibar-tips","ibar-recharge","ibar-cart","ibar-asset","ibar-favorite","ibar-faq"],function(i){"use strict";var t,e,a,n,s,r,o,l,c,d,p,h,u,_,f,m,b,v,g,w,x,y,k,C,I,j,T=i("ibar-fly"),M=i("ibar-monitor"),B=i("ibar-tips"),S=!0,E={iBarRecharge:i("ibar-recharge"),iBarCart:i("ibar-cart"),iBarAsset:i("ibar-asset"),iBarFavorite:i("ibar-favorite"),iBarFaq:i("ibar-faq")},A={zIndex:9990,compactWidth:1050,addCartAjaxUrl:"http://cart.jumei.com/i/cart/ajax_add_to_cart"},J=["普通会员","黄金会员","白金会员","钻石会员"],q=!1,N=Jumei.util,P=N.throttle,z=$(window),R=$(document.body),H=0,L=0,O=[],W=!!~navigator.userAgent.toLowerCase().indexOf("msie 6.0"),U={getCookie:function(i){i=" "+i+"=";var t=document.cookie,e=t.indexOf(i),a=t.indexOf(";",e),n="";return~e&&(~a||(a=t.length),n=t.slice(e+i.length,a)),decodeURIComponent(n)},createiBar:function(i){var t,e,a=U.getCookie("nickname"),n="status_logout",s='<p>你好！请&nbsp;<a href="http://passport.jumei.com/i/account/login">登录</a>&nbsp;|&nbsp;<a href="http://passport.jumei.com/i/account/signup">注册</a></p>',r="http://p0.jmstatic.com/assets/avatar_nonesign.jpg",o=z.height();i.isLogin=""!==a,i.isLogin&&(r=U.getCookie("avatar_small"),e=U.getCookie("privilege_group"),e=J[parseInt(e)],n="status_login",s='<ul class="user_info"><li>用户名：'+a+"</li><li>级&emsp;别："+e+"</li></ul>"),t='<div class="ibar" id="iBar" style="z-index:'+i.zIndex+";height:"+o+'px;"><div class="ibar_main_panel"><ul class="ibar_mp_center"><li class="mpbtn_login"><a href="http://passport.jumei.com/i/account/login"><s></s>登录</a></li><li class="mpbtn_cart"><a href="#" data-plugin="iBarCart"><s></s><span class="text">购物车</span><span class="cart_num">0</span></a></li><li class="mpbtn_asset"><a href="#" data-judgelogin="1" data-plugin="iBarAsset"><s></s>我的财产</a><div class="mp_tooltip">我的财产<s class="icon_arrow_right_black"></s></div></li><li class="mpbtn_favorite"><a href="#" data-judgelogin="1" data-plugin="iBarFavorite"><s></s>我的心愿单</a><div class="mp_tooltip">我的心愿单<s class="icon_arrow_right_black"></s></div></li><li class="mpbtn_recharge"><a href="#" data-plugin="iBarRecharge"><s></s><span class="text">充</span></a><div class="mp_tooltip">我要充值<s class="icon_arrow_right_black"></s></div></li></ul><ul class="ibar_mp_bottom"><li class="mpbtn_qrcode"><a href="#"><s></s>手机聚美</a><div class="mp_qrcode"><img src="http://s0.jmstatic.com/templates/jumei/images/ibar/placeholder.png" data-lazysrc="http://p0.jmstatic.com/assets/qrcode.png?v=0" width="148" height="175" /><s class="icon_arrow_white"></s></div></li><li class="mpbtn_support"><a href="#" data-plugin="iBarFaq"><s></s>客服中心</a><div class="mp_tooltip">客服中心<s class="icon_arrow_right_black"></s></div></li><li class="mpbtn_gotop" id="gotop"><a href="#" class="btn_gotop"><s></s>返回顶部</a><div class="mp_tooltip">返回顶部<s class="icon_arrow_right_black"></s></div></li></ul></div><div class="ibar_login_box '+n+'"><div class="avatar_box"><p class="avatar_imgbox"><img src="'+r+'" alt="头像" width="62" height="62" /></p>'+s+'</div><div class="login_btnbox"><a href="http://www.jumei.com/i/order/list" class="login_order" target="_blank">我的订单</a><a href="http://www.jumei.com/i/product/fav_products" class="login_favorite" target="_blank">我的收藏</a></div><s class="icon_arrow_white"></s><a href="javascript:;" class="ibar_closebtn" title="关闭"></a></div><div class="ibar_sub_panel"><a href="javascript:;" class="ibar_closebtn" title="关闭"></a><span class="ibar_loading_text">正在为您努力加载数据！</span></div><div class="ibar_tips_box"></div></div>',R.append(t),r||$.ajax({url:"http://www.jumei.com/i/ajax/syncCookie",dataType:"jsonp",success:function(i){i.avatar_small&&($("#iBar .avatar_imgbox img")[0].src=i.avatar_small)}})},createAnimElem:function(){var i='<div style="width:45px;height:45px;border-radius:50%;background:#fff;position:absolute;display:none;overflow:hidden;border:1px solid #ed145b;z-index:10002;"><img width="45" height="45"></div>';return $(i)},configAnim:function(i){var t=i.animElem,e=(i.sourceElem,i.numProxyElem),a=i.sourcePos,n=i.targetPos,s=i.animElem.width(),r=i.sourceElem.width()/2-s/2,o={top:a.top,left:a.left+r},c={top:a.top-s-10,left:o.left};t.css({position:"absolute",display:"block",top:o.top+"px",left:o.left+"px",opacity:0}).animate({top:c.top+"px",opacity:1},300,function(){var i=$(this);T.main({flyer:i,starter:null,bubbler:e,targeter:$("li.mpbtn_cart a s"),start:c,target:n,unAnim:!1,bubble:!0,speed:4,isIE6:W,hideDelay:"",targetOffset:{left:12,top:28},complete:function(){l.text(H),i.remove()}})})},getAddCartData:function(i){var e,a,n="http://cart.jumei.com/i/cart/new_items/",s="",r=0;if(i.multiple){for(e=i.sku.length;e>r;r++)a=0===parseInt(i.hashid[r])?"":i.hashid[r],s+=i.sku[r]+","+a+","+i.num[r]+"|";s=s.slice(0,s.length-1)}else i.combt?s=i.combt:(a=0===parseInt(i.hashid)?"":i.hashid,s=i.sku+","+a+","+i.num);q?window.location.href=n+s+"?from="+i.from:$.ajax({url:j,data:{_ajax_:1,items:s,which_cart:i.which_cart,from:i.from},dataType:"jsonp",success:function(e){"success"===e.type?(H=e.cart_item_number,i.callback(),t.trigger("likecartadd")):t.trigger("likecarterror")},error:function(){window.location.href=n+s+"?from="+i.from}})},addCartCallback:function(i){var t,e=$.isArray(i.num)?i.num.length:i.num,a=$(i.elem),n=a.offset(),r=s.offset(),o={};n.top=n.top-a.outerHeight(),a.is(":hidden")&&(a.css({visibility:"hidden",display:"block"}),n=a.offset(),n.top=n.top-a.outerHeight(),a.css({visibility:"",display:"none"})),h||(h=$('<div style="width:13px;height:13px;line-height:13px;z-index:9991;border-radius:50%;background:#ed145b;position:absolute;display:none;overflow:hidden;border:2px solid #ed145b;color:#fff;text-align: center"/>'),R.append(h)),h.text(e),p||(p=U.createAnimElem()),t=p.clone(),t.find("img")[0].src=i.img,R.append(t),o={animElem:t,sourceElem:a,numProxyElem:h,sourcePos:n,targetPos:r},U.configAnim(o)},slideMainPanel:function(i){var t=i?C+"px":"0px";e.is(":animated")&&e.stop(!0,!0),e.animate({left:t},200)},slideCartItem:function(i){var t=i?0-C+"px":"0px",e=function(){s[i?"addClass":"removeClass"]("mpbtn_cart_compact")};s.is(":animated")&&s.stop(!0,!0),s.animate({left:t},200,e)},initMainPanel:function(i){var a,n=z.width();t.unbind("mouseenter.slidemainpanel mouseleave.slidemainpanel"),n<i.compactWidth?(a=parseInt(e.css("left")),0===a&&U.slideMainPanel(!0),U.slideCartItem(!0),U.bindMainPanelSlide()):(a=parseInt(s.css("left")),U.slideMainPanel(!1),0!==a&&U.slideCartItem(!1))},bindMainPanelSlide:function(){t.bind("mouseenter.slidemainpanel",function(){clearTimeout(k);var i=parseInt(e.css("left"));0!==i&&(y=setTimeout(function(){U.slideMainPanel(!1),U.slideCartItem(!1)},200))}).bind("mouseleave.slidemainpanel",function(){clearTimeout(y);var i=parseInt(e.css("left"));o.is(":hidden")&&r.is(":hidden")&&0===i&&(k=setTimeout(function(){U.slideMainPanel(!0),U.slideCartItem(!0)},200))})},initPluginLayout:function(){var i,t,e=document.head||document.getElementsByTagName("head")[0]||document.documentElement,a=".ibar .ibar_sub_panel .ibar_plugin_content",n=z.height()-39;n=Math.max(n,600),i="height:"+n+"px;overflow-y:auto;",t=document.createElement("style"),t.type="text/css",void 0!==t.textContent?t.textContent=a+"{"+i+"}":t.styleSheet.addRule(a,i,0),e.appendChild(t)},reComputedPluginLayout:function(i){var t=i.find(".ibar_plugin_title"),e=i.find(".ibar_plugin_content"),a=z.height();e.css({height:a-t.outerHeight()+"px","overflow-y":"auto"})},initPlugins:function(i){var e,a=$(i),n=$(i).attr("data-plugin"),s=O.length,o=0;if(n&&E[n])if(e=$("#"+n),r.children("div").hide(),c.filter(".current").removeClass("current"),a.addClass("current"),e.length){if(e.show(),t.trigger("likepanelopen",n),"iBarCart"===n&&H!==L)for(L=H;s>o;o++)O[o]();U.reComputedPluginLayout(e)}else setTimeout(function(){E[n].init({container:r});var i=$("#"+n);i.length&&z.height()<650&&U.reComputedPluginLayout(i),t.trigger("likepanelopen",n)},10)},slideCallback:function(i){U.initPlugins(i),R.bind("click.closesubpanel",function(i){var e=i.target;e===t[0]||$.contains(t[0],e)||(U.slideSubPanel(),R.unbind("click.closeloginbox"),t.trigger("mouseleave.slidemainpanel"))})},slideSubPanel:function(i){var e,a=r.is(":visible");i&&(e=$(i).parents("li").find("div.mp_tooltip"),e.length&&e.stop(!0,!0).css("visibility","hidden")),a?i?U.initPlugins(i):(r.animate({left:"0px"},250,function(){r.hide(),c.filter(".current").removeClass("current"),t.trigger("mouseleave.slidemainpanel")}),R.unbind("click.closesubpanel")):(r.children("div").hide(),r.css("display","block").animate({left:0-I+"px"},200,function(){U.slideCallback(i)}))},showTooltip:function(){var i=this;b=setTimeout(function(){var t,e=$(i).find("div.mp_tooltip");e.length&&(t=parseInt(e.css("left")),e.css({left:t-30+"px",opacity:0,visibility:"visible"}).animate({left:t+"px",opacity:1},300))},150)},hideTooltip:function(){var i,t=$(this).find("div.mp_tooltip");t.length&&(clearTimeout(b),i=parseInt(t.css("left")),t.animate({left:i-30+"px",opacity:0},300,function(){t.css({visibility:"hidden",left:"",opacity:""})}))},showSignBox:function(i){var e=$(i),a=e.offset().top;a-=z.scrollTop(),o.css({top:a+"px",display:"block"}),R.bind("click.closeloginbox",function(i){var e=i.target;e===t[0]||$.contains(t[0],e)||(U.hideSignBox(),R.unbind("click.closeloginbox"))})},hideSignBox:function(){o.is(":visible")&&(o.hide(),R.unbind("click.hideloginbox"),t.trigger("mouseleave.slidemainpanel"))},showQrcode:function(){clearTimeout(x),w=setTimeout(function(){var i;_.show(),f&&(i=f.attr("data-lazysrc"),f[0].src=i,f.removeAttr("data-lazysrc"),f=null)},150)},hideQrcode:function(){clearTimeout(w),x=setTimeout(function(){_.hide()},150)},initCartNum:function(){var i="http://cart.jumei.com/i/ajax/get_cart_data_right";$.ajax({url:i,data:{show_type:"all_quantity",_ajax_:1,which_cart:"all"},dataType:"jsonp",success:function(i){i&&l.text(i.quantity)}})},initDom:function(){t=$("#iBar"),e=t.find("div.ibar_main_panel"),a=e.find("li"),n=e.find("li.mpbtn_login").find("a"),s=e.find("li.mpbtn_cart"),r=t.find("div.ibar_sub_panel"),m=t.find("div.ibar_tips_box"),o=t.find("div.ibar_login_box"),l=e.find("span.cart_num"),c=e.find("ul.ibar_mp_center").find("a"),u=e.find("li.mpbtn_qrcode"),_=e.find("div.mp_qrcode"),f=_.find("img"),d=e.find("li.mpbtn_support").find("a")},initEvent:function(i){c.bind("click",function(t){var e=$(this),a=void 0!==e.attr("data-plugin"),n=parseInt(e.attr("data-judgelogin"));a&&(1===n?i.isLogin?U.slideSubPanel(this):(U.hideSignBox(),U.showSignBox(this)):U.slideSubPanel(this)),t.preventDefault()}).bind("mouseleave",function(){clearTimeout(v),g=setTimeout(function(){U.hideSignBox()},200)}),d.on("click",function(i){E.iBarFaq.init(),i.preventDefault()}),a.bind("mouseenter",U.showTooltip).bind("mouseleave",U.hideTooltip),u.bind("mouseenter",U.showQrcode).bind("mouseleave",U.hideQrcode),n.bind("mouseenter",function(){var i=this;clearTimeout(g),v=setTimeout(function(){U.showSignBox(i)},200)}),o.bind("mouseenter",function(){clearTimeout(g)}).bind("mouseleave",function(){clearTimeout(v),g=setTimeout(function(){U.hideSignBox()},200)}),o.find("a.ibar_closebtn").bind("click",function(i){U.hideSignBox(),i.preventDefault()}),r.find("a.ibar_closebtn").bind("click",function(i){U.slideSubPanel(),i.preventDefault()})},init:function(i){q||($("html,body").css("height","100%"),U.createiBar(i),U.initDom(),N.fixed(t[0],{top:"0px",right:"0px"}),t.css("display","block"),j=i.addCartAjaxUrl,C=e.outerWidth(),I=r.outerWidth(),U.initPluginLayout(),void 0!==window.__cartNumber__&&l.text(window.__cartNumber__),window.__initiBar__=!0,U.initEvent(i),U.initMainPanel(i),z.bind("resize.ibar",P(function(){r.is(":visible")&&(r.css({display:"none",left:"0px"}),R.unbind("click.closesubpanel")),U.initMainPanel(i),t.css("height",z.height()+"px")},50)),new Jumei.ui.Gotop({fixed:!1}),M())}},D=function(i){var t=$.extend({},A,i);this.__o__=t,$(function(){U.init(t)})};D.addCart=function(i){S&&(S=!1,i.callback=function(){U.addCartCallback(i)},U.getAddCartData(i),setTimeout(function(){S=!0},2e3))},D.cartUpdate=function(i){"function"==typeof i&&O.push(i)},D.cartNumberUpdate=function(i){l&&l.text(i)},D.faq=function(){E.iBarFaq.init()},D.tips=B,D.prototype={on:function(i,e){if(this.__o__){var a=this;t.bind("like"+i,function(t,n){t.type=i,"string"==typeof n&&(t.pluginName=n),e.call(a,t),t.stopPropagation()})}return this},un:function(i){return this.__o__&&this.__o__.target.unbind("like"+i),this}},window.Jumei=window.Jumei||{},window.Jumei.app=window.Jumei.app||{},window.Jumei.app.iBar=D}),define("wish",function(){"use strict";var i={iframe:"<div class='wish_content' style='display:none'><div class='wish_close'>关闭</div><div class='wish_layer'><p class='wish_tit'>订阅成功</p><div class='wish_layer_wrap'></div></div></div>",success:"<p class='wish_success_tips'><i></i>成功加入心愿单！</p><div class='wish_ok_wrap'>小美会在开团前第一时间发送：短信通知至<b></b></div><p class='wish_cancel'><a href='http://www.jumei.com/i/wishdeal/willsale' target='_blank'>已订阅的开团提醒</a></p><div ><input type='button' value='确定' class='wish_subscribe'/></div>",login:"<p class='wish_layer_tips wish_home_tip'> <span class='wish_tip_img'></span><span class='wish_tip_text'>您尚未登陆哦！</span></p><p class='wish_layer_tips  wish_home_stip'>请在聚美优品网站登陆后，成功绑定手机后</p><p class='wish_layer_tips  wish_home_stip'>尝试重新加入心愿单</p><p style='text-align:center'><a href='' class='wish_a_login'><span class='wish_home_btn'>去登录</span></a></p>",iphone:"<p class='wish_layer_tips wish_home_tip'><span class='wish_tip_img'></span><span class='wish_tip_text'>您尚未绑定手机</span></p><p class='wish_layer_tips wish_home_stip'>请在聚美优品网站绑定手机后，返回本页面</p><p class='wish_layer_tips wish_home_stip'>尝试重新加入心愿单</p><p class='wish_btn wish_btn_p'><a href='' target='_blank'><span class='wish_home_btn wish_dis_p'>绑定手机</span></a></p><p class='wish_btn wish_btn_bind'><span class='wish_home_btn wish_dis_p wish_btn_refresh'>已绑定，重新尝试</span></p><p class='wish_btn wish_btn_bind'><span class='wish_home_btn wish_dis_p wish_btn_cancel'>取消</span></p>"},t="http://www.jumei.com/",e={sku:"",hashid:""},a=function(i,t){var a=$.extend({},e,t);this.__o__=a,this.__o__.target=i,this.element={},this.wishbox=null,this.init(this.__o__)};a.prototype={init:function(i){this.drawBox(i)},drawBox:function(){if($(".wish_content").length<1){var t=$(i.iframe);this.element.wishContent=t,this.element.wishClose=t.find(".wish_close"),this.element.wishLayer=t.find(".wish_layer"),this.element.wishTit=t.find(".wish_tit"),this.element.layerWap=t.find(".wish_layer_wrap"),$("body").append(t),this.wishbox=new Jumei.ui.Dialog("body",{elem:".wish_content",effects:"zoom",trigger:"WishEvent"})}},showBox:function(e){var a=this,n={},s="";switch(e){case"login":n={width:"350px",height:"228px"},$(".wish_content,.wish_layer").css(n),this.element.wishTit.html("温馨提示");var r=location.href;s=t+"/i/account/login/?redirect="+r,this.element.layerWap.html(i[e]),this.element.layerWap.find(".wish_a_login").attr({href:s}),$("body").trigger("WishEvent");break;case"iphone":n={width:"350px",height:"235px"},$(".wish_content,.wish_layer").css(n),this.element.wishTit.html("温馨提示"),s=t+"i/account/mobile_bind_status",this.element.layerWap.html(i[e]),this.element.layerWap.find(".wish_btn_p a").attr({href:s}).bind("click",function(){$(this).hide(),a.element.layerWap.find(".wish_btn_bind").show()}),this.element.layerWap.find(".wish_btn_refresh").bind("click",function(){a.phoneBind()}),$("body").trigger("WishEvent");break;case"success":n={width:"350px",height:"228px"},$(".wish_content,.wish_layer").css(n),this.element.layerWap.html(i[e]),this.element.layerWap.find(".wish_ok_wrap b").html(a.__o__.iphone?a.__o__.iphone:""),$("body").trigger("WishEvent")}$(".wish_close,.wish_btn_cancel,.wish_subscribe").click(function(){a.wishbox.close()})},addWish:function(){var i=t+"i/wishdeal/ajax_add_jsonp",e=this,a=this.__o__.sku+","+this.__o__.hashid+",1";$.ajax({url:i,type:"get",data:{item:a},dataType:"jsonp",success:function(i){0===i.errno?(e.__o__.iphone=i.data.mobile,e.showBox("success")):-1===i.errno?e.phoneBind():alert("请求错误，请刷新重试！")},error:function(){alert("请求地址错误，请刷新重试！")}})},phoneBind:function(){var i=this;$.ajax({url:t+"i/account/ajax_is_mobile_bind2?callback=?",dataType:"jsonp",success:function(t){t?(i.__o__=$.extend(i.__o__,t),"1"===i.__o__.is_bind||1===i.__o__.is_bind?i.addWish():i.showBox("iphone")):alert("数据错误！")},error:function(){alert("请求错误，请刷新重试！")}})},checkState:function(i,t){this.__o__.sku=i,this.__o__.hashid=t,""!==this.__o__.sku&&""!==this.__o__.hashid&&(""!==Jumei.util.cookie.get("uid")?this.phoneBind():this.showBox("login"))}},window.Jumei=window.Jumei||{},window.Jumei.app=window.Jumei.app||{},window.Jumei.app.WishLayer=a}),define("cart",["cart-box","cart-bar"],function(i){"use strict";var t={CartBox:i("cart-box"),CartBar:i("cart-bar")},e={isCart:!0,isBar:!1},a=($(window),$(".home_nav_bar")),n=$(".product_introduce,.brand_list_box"),s=$(".global_wrapper"),r=(a.find(".li_cart_content"),$(".cart_flag_all").find(".cart_box")),o={showCart:function(){r.length>0&&t.CartBox.init({container:r})},showBar:function(){a.length>0&&t.CartBar.init({container:a,navcon:n,body:s})},init:function(i){i.isCart&&o.showCart()}},l=function(i){var t=$.extend({},e,i);this.__o__=t,o.init(t)};window.Jumei=window.Jumei||{},window.Jumei.app=window.Jumei.app||{},window.Jumei.app.Cart=l}),define("appdeal",["cart","wish","ibar"],function(i){i("cart"),i("wish"),i("ibar")});